'use strict';mix_d("P13NSCCards__p13n-rvi:p13n-rvi__wXbIDDGB","exports tslib @p/A @c/aui-carousel @c/dom @c/remote-operations @c/scoped-dom @p/a-carousel-framework @c/metrics @c/logger @c/aui-untrusted-ajax @c/browser-operations".split(" "),function(z,u,C,D,E,F,G,H,I,J,K,L){function w(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}var p=w(C),M=w(D),N=w(F),v=w(G),O=w(H),x=w(J),P=w(K),Q=w(L),R=function(a){var e=function(c){c.popover&&c.popover.getContent&&(c=c.popover.getContent(),
p["default"].loadDescendantImagesManually(c))},b=function(c,g){g={$event:{preventDefault:p["default"].$.noop,stopPropagation:p["default"].$.noop},$target:c.getContent().find('[data-a-tab-name="'+g+'"]'),data:{name:"energyEfficiencyTabSet"}};p["default"].trigger("a:declarative:a-tabs:click",g);p["default"].on("a:tabs:energyEfficiencyTabSet:select",function(d){switch(d.selectedTab.tabName){case "firstTab":c.$popover.css("width","367px");c.$popover.css("height","600px");c.$popover.find(".a-popover-inner").css("height",
"600px");break;case "secondTab":c.$popover.css("width","800px"),c.$popover.css("height","1100px"),c.$popover.find(".a-popover-inner").css("height","1100px")}})},f=function(c,g){var d=c&&c.$event,n=c&&c.data||{},l=n.activeTabName,r=n.name;d&&d.preventDefault&&d.preventDefault();d&&d.stopPropagation&&d.stopPropagation();d=g.get(r);d||(p["default"].on("a:popover:befo/reshow:"+r,e),d=g.create(c.$target,n));d.show();b(d,l)};a.when("a-secondary-view").execute("RegisterEnergyEfficiencyEventMobile",function(c){p["default"].declarative("card-energy-efficiency-secondary-view",
"click",function(g){f(g,c)})});a.when("a-modal").execute("RegisterEnergyEfficiencyEventDesktop",function(c){p["default"].declarative("card-energy-efficiency-modal","click",function(g){f(g,c)})})},S=function(a){a.when("ready").execute("EEBadgeProductFiche/resize",function(e){var b=p["default"].$;b(".energyEfficiencyContainer").each(function(f,c){f=b(c).find(".energyEfficiencyProductFicheLabel").first();var g=b(c).find("svg").first();c.offsetWidth<f.width()+g.width()&&(f.removeClass("a-size-small"),
f.addClass("a-size-micro"))})})},T={ctiList:["Website/Personalization/Report a Problem CX"],category:"Website",type:"Personalization",item:"Report a Problem CX",folder:"9c9c97c9-6f69-4dba-a55d-26045c6a3068",group:"P13N Report a Problem CX"},U=[{ctiList:["Website/Personalization/Similarities","Website/Detail Page/Similarities"],category:"Website",type:"Personalization",item:"Similarities",folder:"4d16d05d-9a17-4b36-b8fe-9ee159ff81de",group:"Similarities"}],Y=function(a){var e=v["default"].cardRoot.querySelector(".p13n-report-flag"),
b=Q["default"].setup();b.define("showFlag","mouseover",function(){e.classList.remove("p13n-report-flag-hide")});b.define("hideFlag","mouseout",function(){e.classList.add("p13n-report-flag-hide")});b.attach("showFlag",a);b.attach("hideFlag",a);var f=v["default"].cardRoot.querySelector(".internal-flag-form"),c=f.querySelector(".internal-flag-env-data").dataset,g=f.querySelector(".internal-flag-title-text"),d=f.querySelector(".internal-flag-description").firstElementChild,n=f.querySelector(".internal-flag-alias"),
l=f.querySelector(".internal-flag-/response-message"),r=function(k){k.preventDefault();k=function(t){return!t||!t.trim()};if(k(g.value)||k(d.value)||k(n.value))return y(l,!1,"Something went wrong. One of the required fields was missing."),!1;k=v["default"].cardRoot.querySelectorAll(".a-dynamic-image");var h;if(h=v["default"].cardRoot.querySelector(".a-carousel-heading")){var q=V(a,k.length);h="Internal user reported issue '"+g.value+"' with widget: "+h.innerText}else q=W(a),h="Internal user reported issue '"+
g.value+"'";k=X(k,q,d.value,n.value,c);var m=T;U.forEach(function(t){t.ctiList.includes(c.cti)&&(m=t)});P["default"].post("https://p13ngoals.corp..com/sims",{accepts:"text/html, application/json",contentType:"application/json;charset=UTF-8"},{sim_params:{assigned_folder:m.folder,description:k,descriptionContentType:"text/amz-markdown-sim",extensions:{tt:{assignedGroup:m.group,category:m.category,impact:5,item:m.item,type:m.type}},tags:[{id:"internal-problem-generated"}],title:h}}).then(function(t){y(l,
!0,t)}).catch(function(t){y(l,!1,t)});return!1};f.onsubmit=function(k){return r(k)};b=v["default"].cardRoot.querySelector(".p13n-desktop-report-problem-flag-data");if(b.dataset.name)p["default"].on("a:popover:hide:"+b.dataset.name,function(){f./reset();l.innerText=""})},V=function(a,e){if(!a.dataset.aCarouselOptions)return x["default"].log("Empty ASIN List in carouselElement.dataset.aCarouselOptions","ERROR"),[];a=JSON.parse(a.dataset.aCarouselOptions).ajax.id_list;var b=v["default"].cardRoot.querySelector(".a-carousel-firstvisibleitem");
b=(Number(b.value)||1)-1;return a.map(function(f){return JSON.parse(f).id}).slice(b,b+e)},W=function(a){return(a=a.dataset.asinList)?a.split(","):[]},X=function(a,e,b,f,c){for(var g="",d=0;d<a.length;d++){var n=a[d];g+=(n?"![]("+n.src+")":"IMAGE MISSING")+"\nASIN: "+(e[d]?e[d]:"ASIN MISSING")+"\n\n"}return"**This SIM-T ticket is created by the 'Report a Problem' internal tool. To know more, here's its wiki: https://w..com/bin/view/Personalization/CoreRecommendations/Projects/Canaries/Report-a-Problem-UX-on-P13NWidget/UserGuide/**\n\n**Alias:** ["+
(f+"](https://phonetool..com/users/"+f+")\n**Comment:** "+b+"\n\n**Widget Group ID:** "+c.widgetGroupId+"\n**Strategy ID:** "+c.strategyId+"\n**CTI:** "+c.cti+"\n**Facets:** ")+(c.facets+"\n**Content Reftag:** "+c.reftag+"\n"+(""!==c.baseAsin?"**Page ASIN:** "+c.baseAsin+"\n":"")+"\n**SessionID:** ")+(c.sessionId+"\n**MarketplaceID:** "+c.marketplaceId+"\n**Device Type:** "+c.deviceType+"\n\n**List of ASINs:**\n\n")+g},y=function(a,e,b){e?(a.classList.remove("a-color-error"),b./responseBody&&
"object"===typeof b./responseBody?b./responseBody./response&&b./responseBody./response.id?a.innerHTML="Success, here's the <a href=\"https://t.corp..com/"+b./responseBody./response.id+'" target="_blank">SIM-T ticket</a> you created.':(x["default"].log("Fail to find the id of the SIM-T ticket created in the /response body of /response data.","ERROR"),a.innerText="Success, but we could not find the link to the SIM-T ticket."):(x["default"].log("The /response body of /response data is not an object.","ERROR"),
a.innerText="Success, but we could not find the link to the SIM-T ticket.")):(a.classList.add("a-color-error"),a.innerText="string"===typeof b?b:"Oops! Something went wrong. Please try again.")},Z={setupModal:function(a){return u.__awaiter(void 0,void 0,void 0,function(){var e;return u.__generator(this,function(b){e=v["default"].cardRoot.querySelector(".p13n-report-problem-modal-root");if(!e)return[2];Y(a);return[2]})})}},aa=function(a){var e=Array.prototype.slice.call(a.querySelectorAll("[data-metrics]"));
e.push(a);e.forEach(function(b){if(b&&b.dataset&&b.dataset.metrics){var f=JSON.parse(b.dataset.metrics),c;for(c in f)f.hasOwnProperty(c)&&I.count(c,f[c]);b.removeAttribute("data-metrics")}})},A=/(?=[ \-\/])|(?=[\u3105-\u312F])|(?=[\u31A0-\u31BA])|(?=[\u4E00-\u9FD5])|(?=[\u3400-\u4DB5])|(?=[\uF900-\uFAFF])|(?=[\u3040-\u309F])|(?=[\u30A0-\u30FF])|(?=[\u3190-\u319F])/,B=/[^\/\-\[\]():\s]/,ba=function(a){var e=p["default"].$("<div>")[0];e.classList.add("p13n-sc-offscreen-truncate");var b=parseInt(a.getAttribute("data-rows")||
"2",10),f=function(){var d=a.innerHTML;a.innerHTML="&hellip;";var n=a.clientHeight;a.innerHTML=d;return n}();if(b){if(f){var c=function(d){e.innerHTML=d;return Math.round(e.clientHeight/f)<=b},g=function(d,n){d=d.split(n);var l=Math.floor(a.clientWidth/12),r=function(h){e.classList.add("p13n-sc-offscreen-truncate");e.style.overflow="hidden";e.textContent=h;a.appendChild(e);h=a.clientWidth>=a.scrollWidth;a.removeChild(e);return h},k=function(h){var q=h.length-l;h.trim().length>l&&!r(h)&&Array.prototype.slice.call(h).map(function(m,
t){return t>l&&t<=q&&B.test(m)?"&shy;"+m:m});return h};return d.map(function(h){return k(h)}).join("")};return{truncate:function(){var d=a.innerHTML.trim(),n=a.textContent||"";d=g(d,A);a.appendChild(e);if(c(d))a.removeChild(e),a.innerHTML=d;else{var l=d.split(A);for(var r=1,k=l.length,h,q,m=0;r!==k;)if(h=Math.floor((k+r)/2),q=l.slice(0,h).join("")+"&hellip;",c(q)){if(1>=k-h){for(m=h;0<m&&!B.test(l[m-1]);)m--;break}r=h}else k=h;l=0===m?void 0:l.slice(0,m).join("")+"&hellip;";l?(a.innerHTML=l,a.setAttribute("title",
n)):(x["default"].log("Unable to successfully truncate line "+d,"ERROR"),a.removeChild(e))}}}}x["default"].log("Truncation element does not have a line height or it is zero","ERROR")}else x["default"].log("Truncation element missing necessary line number data","ERROR")},ca=function(a){var e=Array.prototype.slice.call(a.getElementsByClassName("p13n-sc-truncate"));a=a.getElementsByClassName("p13n-sc-truncate-fallback");(window.CSS&&CSS.supports&&CSS.supports("-webkit-line-clamp","1")?e:e.concat(Array.prototype.slice.call(a))).filter(function(b){return!!b.offsetParent}).map(function(b){var f=
ba(b);f&&(f.truncate(),b.classList.add("p13n-sc-truncated"),b.classList.remove("p13n-sc-truncate"),b.classList.remove("p13n-sc-truncate-fallback"),b.className=b.className.replace(/p13n-sc-line-clamp-\d/g,""))})},da={initCarousel:function(a){return u.__awaiter(void 0,void 0,void 0,function(){var e,b,f;return u.__generator(this,function(c){e=(a||{}).afterPageLoaded;b=v["default"].cardRoot.classList.contains("p13n-sc-shoveler")?[v["default"].cardRoot]:Array.prototype.slice.call(v["default"].cardRoot.getElementsByClassName("p13n-sc-shoveler"));
f=N["default"].setup(["getCarouselItems"]);if(null===b||void 0===b||!b.length)return[2];b.forEach(function(g){return u.__awaiter(void 0,void 0,void 0,function(){var d,n,l,r,k;return u.__generator(this,function(h){switch(h.label){case 0:d=function(){p["default"].loadDynamicImage("[data-name]='"+k+"' .p13n-sc-dynamic-image");ca(g);aa(g);null===e||void 0===e?void 0:e(g);var q=window.P;R(q);S(q)};d();if(g.classList.contains("p13n-carousel-initialized"))return[2];g.classList.add("p13n-carousel-initialized");
n=O["default"].getCarousel(E.unscope(g));l=M["default"].getCarousel(g);r=g.dataset||{};k=n.getAttr("name");return[4,Promise.all([l.initialized,Z.setupModal(g)])];case 1:return h.sent(),p["default"].on("a:carousel:"+k+":change:pageSize",d),p["default"].on("a:carousel:"+k+":change:loading",d),p["default"].on("a:carousel:"+k+":change:animating",d),p["default"].on("a:carousel:"+k+":change:fetchedItems",d),l.attachRemoteOperation(function(q){var m=q.indexes;q=q.ids;return f.getCarouselItems(u.__assign(u.__assign({},
r),{ids:q,indexes:m,offset:String(m[0]||0)}))}),[2]}})})});return[2]})})}};z._operationNames=["getCarouselItems"];z.card=function(){return u.__awaiter(void 0,void 0,void 0,function(){return u.__generator(this,function(a){switch(a.label){case 0:return[4,da.initCarousel()];case 1:return a.sent(),[2]}})})}});
