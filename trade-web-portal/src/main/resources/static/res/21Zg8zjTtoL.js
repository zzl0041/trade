(function(f){var c=window.UIPageJS||window.P,k=c._namespace||c.attributeErrors,a=k?k("StarlingInte/restGroupAssignment",""):c;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,c,k){f.register("StarlingIGJoinConfiguration",function(){var a="B085VQVPJK B07WMLPSRL B085VNCZHZ B085VM9ZDD B085WSCTS4 B08ZK2BHP2 B091G65HH6 B09SR86FFF B08ZK3D89L B097VJS3Y3 B08ZK39NSL B07DPNSW6P B071DWXLYL B085WS7H6K B091G68F8C B07DPND6BB B07WGJ8ZD3 B09SR451K2 B0866V73R6 B091G64GVK B085VNCZHL B09M71XXN3 B08R5JZRWQ B0B5M35RC3 B07XJ8C8F5 B084J4KNDS B084J4MZK8 B084J4MJCK B084J4QQK1 B07FZ8S74R B07PDHSLM6 B07PGL2N7J B07W95GZNH B07XJ8C8F7 B085M66LH1 B07XKF5RM3 B07XKF75B8 B085HK4KL6 B07G9Y3ZMC B08J8FFJ8H B08J8H8L5T B08KJN3333 B08LMSC4WZ B07PF1Y28C B07RQ3TCT2 B084DC4LW6 B084DCJKSL B07VHZ41L8 B082X1HRV5 B08MQLDFF6 B07VTK654B".split(" ");
return{getApprovedAsins:function(){return a},getRoboticSessionId:function(){return"000-0000000-0000000"},getSecondsPerDay:function(){return 86400},getToken:function(a){switch(a){case "gamma":return"Ay3WBRr5OtmyD3mwpIWyox6nl2xsEL3JyighG4NpbfO3kyka10dzD97eJA+ekMnq3XLi8hPC8gpBGSClwt5wEgYAAACaeyJvcmlnaW4iOiJodHRwczovL2F0LWdhbW1hLXVzLWVhc3QuYW1hem9uLWFkc3lzdGVtLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ\x3d\x3d";
case "prod":return"A7jDbyz2LmRMzv5b5laRj897GzAsLHZaNDTnlB+0XsNiHLfX8/4RcCUioP/IY9mxlewyosoNcmkbGyxc62ag1gcAAACEeyJvcmlnaW4iOiJodHRwczovL3d3dy5hbWF6b24uY29tOjQ0MyIsImZlYXR1cmUiOiJQcml2YWN5U2FuZGJveEFkc0FQSXMiLCJleHBpcnkiOjE2ODA2NTI3OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"}}}});"use strict";f.register("StarlingAddMetric",function(){return{addMetric:function(a,b){c.ue&&c.ue.count&&c.ue.count(a,b)}}});"use strict";f.register("StarlingLogError",function(){return{logError:function(a){var b=
{logLevel:2<arguments.length&&arguments[2]!==k?arguments[2]:"ERROR",attribution:"StarlingInte/restGroupAssignment",message:1<arguments.length&&arguments[1]!==k?arguments[1]:""};c.ueLogError&&c.ueLogError(a,b);return[a,b]}}});"use strict";f.when("StarlingIGJoinConfiguration","StarlingAddMetric","StarlingLogError").register("StarlingIGJoinHelpers",function(a,b,g){function d(){return c.opts.customerId}function e(a){switch(a){case "beta":return"https://at-"+a+".-adsystem.com";case "gamma":return"https://at-"+
a+"-us-east.-adsystem.com";case "prod":return"https://at-us-east.-adsystem.com"}}function f(a){if(a){if((a=JSON.parse(JSON.stringify(a)).inte/restGroups)&&Array.isArray(a)&&0<a.length)return b.addMetric("Starling:AttemptedIGAdd",a.length),a;b.addMetric("Starling:GatewayReturnedIGMetadata:False",1);a={message:"Starling:GatewayReturnedIGMetadata:False. IG Metadata from Gateway is empty or incorrect format."};g.logError(a);return null}b.addMetric("Starling:NullGateway/responseError",1);a={message:"Starling:NullGateway/responseError. Null IGMetadata /response from Gateway."};
g.logError(a)}function n(a,b){return new Promise(function(h,d){try{navigator.joinAdInte/restGroup(a,30*b),h()}catch(r){d(r)}})}function q(a,b){var h=[],d=!0,e=!1,g=k;try{for(var c=a[Symbol.iterator](),f;!(d=(f=c.next()).done);d=!0)h.push(n(f.value,b))}catch(t){e=!0,g=t}finally{try{!d&&c.return&&c.return()}finally{if(e)throw g;}}return h}function l(a,e){var h=0,c=0;a=q(a,e);Promise.allSettled(a).then(function(a){var e=!0,g=!1,f=k;try{for(var m=a[Symbol.iterator](),p;!(e=(p=m.next()).done);e=!0)"fulfilled"===
p.value.status?h+=1:c+=1}catch(u){g=!0,f=u}finally{try{!e&&m.return&&m.return()}finally{if(g)throw f;}}b.addMetric("Starling:BrowserAddedToIG:True",h);b.addMetric("Starling:BrowserAddedToIG:False",c);d()?b.addMetric("Starling:IGAssigned:Customer",h):b.addMetric("Starling:IGAssigned:Guest",h)}).catch(function(a){b.addMetric("Starling:Promise/resolverError",1);g.logError(a,"Starling:Promise/resolveError. Error /resolving IGJoinPromiseArray.")})}var v=/development|integ|beta|corp/,w=/pre-prod|preprod|gamma|master/,
x=/prod/;return{browserSupportsAdInte/restGroup:function(){return"joinAdInte/restGroup"in navigator&&document.featurePolicy.allowsFeature("join-ad-inte/rest-group")},getWindowConfig:function(){return c.config},getWindowOpts:function(){return c.opts},getHref:function(){return c.location.href},getCustomerId:d,getCampaignScope:function(b){return a.getApprovedAsins().includes(b)},getApnPrivacySetting:function(){if(null!==document&&null!==document.cookie){var a=document.cookie.match(/(^| )apn-privacy=([^;]+)/);
if(a)return"true"===a[2]}return!1},getSushiEndpoint:function(a){return JSON.parse(JSON.stringify(a))["Events.SushiEndpoint"]},getStage:function(a){if(v.test(a))return"beta";if(w.test(a))return"gamma";if(x.test(a))return"prod"},generateGatewayUrl:e,provideToken:function(a){if(null!==document&&null!==document.head){var b=document.createElement("meta");b.httpEquiv="origin-trial";b.content=a;document.head.appendChild(b)}},parseIGMetadataFrom/response:f,createIGJoinPromise:n,createIGJoinPromiseArray:q,
settleIGJoinPromises:l,joinAdInte/restGroups:function(d,c){var h=a.getSecondsPerDay();c=e(c);fetch(c+"/inte/restGroups/join/",{method:"PUT",body:JSON.stringify(d)}).then(function(a){return a.json()}).then(function(a){(a=f(a))&&l(a,h)}).catch(function(a){b.addMetric("Starling:ParseGateway/responseError",1);g.logError(a,"Starling:ParseGateway/responseError. Error parsing IG Metadata from Gateway.")})}}});"use strict";f.register("StarlingInte/restGroupAssign",function(){var a={init:function(b,c,d,e){a.config=
b;a.helpers=e;a.metrics=c;a.errors=d;b=a.config.getRoboticSessionId();c=a.config.getApprovedAsins();(d=a.helpers.getWindowConfig())?(d=a.helpers.getSushiEndpoint(d))?(d=a.helpers.getStage(d))?(e=a.config.getToken(d),a.helpers.provideToken(e),a.assignIG(d,b,c)):(a.metrics.addMetric("Starling:StageRetrievedError",1),b={message:"Starling:StageRetrievedError. Error getting stage."},a.errors.logError(b)):(a.metrics.addMetric("Starling:SushiEndpointRetrievedError",1),b={message:"Starling:SushiEndpointRetrievedError. Error getting sushi endpoint."},
a.errors.logError(b)):(a.metrics.addMetric("Starling:PageLoadError",1),b={message:"Starling:PageLoadError. Error getting window config."},a.errors.logError(b))},assignIG:function(b,c,d){if(a.helpers.browserSupportsAdInte/restGroup()){a.metrics.addMetric("Starling:BrowserSupportsAdInte/restGroup:True",1);var e=a.helpers.getWindowOpts();if(e){d=e.sessionId;var f=e.pageType;e=e.asin;var g=a.helpers.getApnPrivacySetting(),k=a.helpers.getHref;c=d===c;var l=a.helpers.getCampaignScope(e);g||c||!l?a.metrics.addMetric("Starling:TotalPunts",
1):a.helpers.joinAdInte/restGroups({identity:{sessionId:d},pageInformation:{pageURL:k,pageType:f,asins:[e]}},b);g&&a.metrics.addMetric("Starling:UserOptedOut:True",1);c&&a.metrics.addMetric("Starling:RoboticTraffic:True",1);l||a.metrics.addMetric("Starling:InCampaignScope:False",1);a.helpers.getCustomerId()?a.metrics.addMetric("Starling:BrowserSupportsAdInte/restGroup:Customer",1):a.metrics.addMetric("Starling:BrowserSupportsAdInte/restGroup:Guest",1)}else a.metrics.addMetric("Starling:OptsNotFoundError",
1),a.errors.logError({message:"Starling:OptsNotFoundError. Error getting windowOpts."})}else a.metrics.addMetric("Starling:BrowserSupportsAdInte/restGroup:False",1)}};return a});f.when("StarlingIGJoinConfiguration","StarlingAddMetric","StarlingLogError","StarlingIGJoinHelpers","StarlingInte/restGroupAssign","ready").execute(function(a,b,c,d,e){e.init(a,b,c,d)})});